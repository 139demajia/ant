import "@ant.animation"
import "@ant.render"

policy "skinning"
    .require_system "ant.animation|skinning_system"
    .require_transform "mesh_skinning"
    .require_transform "build_pose_result"
    .require_transform "skinning_material"
    .require_transform "skinning_type_transform"
    .require_transform "skinning_rendermesh"
    .component "material"
    .component "animation"
    .component "skeleton"
    .component "mesh"
    .component "meshskin"

transform "skinning_type_transform"
    .implement "skinning/gltf_skinning.lua"
    .output "skinning_type"
    .method "process_prefab"

transform "mesh_skinning"
    .implement "skinning/gltf_skinning.lua"
    .input "mesh"
    .input "pose_result"
    .input "skinning_type"
    .input "meshskin"
    .output "skinning"
    .method "process_entity"

transform "skinning_rendermesh"
    .implement "skinning/gltf_skinning.lua"
    .require_transform "mesh_skinning"
    .input "skinning"
    .input "_rendercache.render"
    .output "_rendercache.skinning_render"
    .method "process_entity"
